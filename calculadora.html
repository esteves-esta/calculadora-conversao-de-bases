<!DOCTYPE html>
<html lang="pt">
<head>

	<meta charset="utf-8">
	<title>Calculadora</title>

	<style type="text/css">
		
		*{
			margin:0px;
			padding: 0px;
			box-sizing: border-box;
			font-family: 'Calibri', sans-serif;
		}

		body{
			display: flex;
			flex-wrap: wrap;
			flex-direction: row;
			justify-content: space-around;
			align-items: center;
			height: 100vh;
		}

		input, select, button{
			width: 200px;
			display: block;
			padding: 8px 5px;
			margin: 15px 0px;
		}

		label{
			display: block;
		}

		article{
			width: 50%;
		}

	</style>
</head>
<body>

	<article>
		
		<h2>Calculadora</h2>

		<form>
			

			<label>Selecione o tipo de conversão: </label>

			<label>De: </label>
			<select id="de">
				<option value="" selected disabled>Tipo de número</option>
				<option value="1">Binário</option>
				<option value="2">Decimal</option>
				<option value="3">Octal</option>
				<option value="4">Hexadecimal</option>
			</select>

			<label>Para: </label>
			<select id="para">
				<option value="" selected disabled>Tipo de converção</option>
				<option value="1">Binário</option>
				<option value="2">Decimal</option>
				<option value="3">Octal</option>
				<option value="4">Hexadecimal</option>
			</select>

			<label>Digite o número a ser convertido</label>
			<input type="text" id="numero">

			<label>Resultado da Conversão:</label>
			<input type="text" id="convertido" disabled placeholder="Conversão">

			<button type="button" onclick="conversaoBases()">Converter</button>

			<button type="reset">Resetar formulário</button>

		</form>

	</article>

</body>
</html>

<script type="text/javascript">
	var converterDe = document.getElementById("de");
	var converterPara = document.getElementById("para");
	var numInserido = document.getElementById("numero");
	var resultado = document.getElementById("convertido");
	

	function conversaoBases(){

		switch(converterDe.value){
			case '1':
			//BINÁRIO

				switch(converterPara.value){
					case '1':
						alert('Não pode converter pro mesmo tipo né');
						break;
					case '2':
						//DECIMAL
						resultado.value = binarioToDecimal(numInserido.value);
						break;
					case '3':
						//OCTAL
						resultado.value = binarioToOctal(numInserido.value);
						break;
					case '4':
						//HEXADECIMAL
						resultado.value = binarioToHexa(numInserido.value);
						break;
				}
			break;
			case '2':
				//DECIMAL
			break;
			case '3':
				//OCTAL
			break;
			case '4':
				//HEXADECIMAL
				switch(converterPara.value){
					case '1':
					//BINÁRIO
					resultado.value = hexaToBinario(numInserido.value);
					break;
					case '2':
					//DECIMAL
					resultado.value = hexaToDecimal(numInserido.value);
					break;
					case '3':
					//OCTAL
					resultado.value = hexaToOctal(numInserido.value);
					break;
				}
			break;
		}

	}

//---------------------------------------------------------------

	//FUNÇÃO QUE TRANFORMA NÚMERO DE BINÁRIO PARA DECIMAL
	// 		a função pega cada caracter do fim ao começo
	// 		e verifica se é o numero 1
	// 		se for verdadeiro ele irá potencializar 2 à posição do caracter 
	// 		que é contada pela variavel posicaoDoCaracter
	// 		e o resultado é armazenar na variável numResultado 
	// 		e somado com o contéudo já presente nesta variável
	//  
	function binarioToDecimal(num){

		// remover espaços em branco da string
		num = num.replace(/ /g,'');

		//variavel onde será armazenado o resultado
		var numResultado = 0;

		//valor para saber em que posição do número está
		//esse valor será aumentando por 1 a cada loop 
		var posicaoDoCaracter = 0;

		//valor do comprimeto do numero/string -1 para começar do primero numero da direita
		//esse valor será diminuido por 1 a cada loop
		var comprimentoAoContrario = num.length - 1;


		//se o numero atual for 1
		//entrar e potenciar 2 pela posição do caracter
		//e armazenar na variavel numResultado
		//e somar com o contéudo desta variável
		for (var i = 0; i < num.length; i++) {

			if(num.charAt(comprimentoAoContrario) === '1'){
				numResultado = numResultado + (2 ** posicaoDoCaracter);
			}

			posicaoDoCaracter++;
			comprimentoAoContrario--;
		}

		return numResultado;
	}




//--------------------------------------------------------------
	//FUNÇÃO QUE TRANSFORMA DE BINÁRIO PARA OCTAL
	//		separar conjuntos de 3 bits, do fim da da string para o começo 
	//		(da direita para  esquerada)
	//		colocar os numeros numa string para exibilos sem virgula
	// 		e colocar os números na ordem correta

	function  binarioToOctal(num){

		// remover todos os espaços em branco da string
		num = num.replace(/ /g,'');

		// comeco e fim para usar na função substring
		var comeco = num.length;
		var fim = num.length - 3;

		//array para guardar cada conjunto de 3 bits
		var arrayResultado = Array();

		for (var i = 0; i < num.length; i++) {
			if(num.substring(comeco, fim) == ''){
				//se não houver mais numeros ele irá sair do looop
				break;
			}

			//passa cada conjunto de 3 bits para a função de binario para decimal
		 	arrayResultado[i] = binarioToDecimal(num.substring(comeco, fim));

		 	//fim e comeco somados com 3 para ir pegando cada tres bits do numero
			fim = fim - 3;
			comeco = comeco - 3;

		}

		//loop para colocar os numeros numa variavel para exibi-los sem as virgulas da array
		var resultadoContrario = arrayResultado.toString().replace(/,/g, '');
		var resultado = '';

		for(var i = resultadoContrario.length-1; i >= 0; i--){
			resultado = resultado + '' + resultadoContrario[i];
		}		

		return resultado;
	}


//---------------------------------------------------------
	// FUNÇÃO PRA CONVERTER DE BINÁRIO PARA HEXADECIMAL
	//		separar conjuntos de 4 bits, do fim da da string para o começo 
	//		(da direita para esquerada)
	// 		e passa-los pela funcao que converte de binario para hexadecimal
	//		e depois converter numeros de 10 a 15 para letra
	// 		e colocar os números na ordem correta
	function binarioToHexa(num){

		// remover espaços em branco da string
		num = num.replace(/ /g,'');

		// comeco e fim para usar na função substring
		var comeco = num.length;
		var fim = num.length - 4;

		// array para guardar cada conjunto de 4 bits
		var arrayResultado = Array();

		for (var i = 0; i < num.length; i++) {
			if(num.substring(comeco, fim) == ''){
				// se não houver mais numeros ele irá sair do looop
				break;
			}

			// passa cada conjunto de 4 bits 
			// para a função de binario para decimal
		 	arrayResultado[i] = binarioToDecimal(num.substring(comeco, fim));

		 	// fim e comeco subtraidos com 4
		 	// para pegar o próximo conjunto de 4 bits
			fim = fim - 4;
			comeco = comeco - 4;
		}

		// loop para colocar os numeros 
		// numa variavel para exibi-los sem as virgulas da array
		// e modificar os números de 10 a 15 para A a F
		var resultado = '';
		var numeroEmOrdem = [];
		var indexContrario = arrayResultado.length-1;

		for(var i = 0; i < arrayResultado.length; i++){
			var numNormal = [10, 11, 12, 13, 14, 15];
			var numLetra = ['A', 'B', 'C', 'D', 'E', 'F'];

			for(var x = 0; x < numNormal.length; x++){
				if(arrayResultado[i] === numNormal[x]){
					// se for igual mudar para o mesmo index na array com letras
					arrayResultado[i] = numLetra[x];
					break;
				}
			}	
				numeroEmOrdem[indexContrario] = arrayResultado[i];
				indexContrario--;
		}

		resultado = numeroEmOrdem.toString().replace(/,/g,'');

		return resultado;
	}




//----------------------------------------------------------------
function hexaToBinario(num){
	//colocar numeros na array
	var numArray = Array();
	for(var i = 0; i < num.length; i++){
		numArray[i] = num.charAt(i);
	}

	//transformar letras em numeros se houver
	for(var i = 0; i < numArray.length; i++){
		var numNormal = [10, 11, 12, 13, 14, 15];
		var numChange = ['A', 'B', 'C', 'D', 'E', 'F']; 

		for(var x = 0; x < numNormal.length; x++){

			if(numArray[i] === numChange[x]){
				numArray[i] = numNormal[x];
				break;
			}
			else{
				numArray[i] = parseInt(numArray[i]);
			}
		}	
	}

	//console.log(numArray);
	//console.log(toBinario(numArray));
	
	//Pega número convertido para binario e coloca em string
	var nuBi = toBinario(numArray);
	var numString = '';
	for (var i = 0; i < nuBi.length; i++) {
		numString = numString + nuBi[i];
	}

	return numString;

}

//-----------------------------------------------------
function toBinario(num){
	
	var numBinarioCerto = Array();
	var mat=0;
	var zer = 0;
	var i = 0; 

	while (i < num.length) {
		var numBinario = [];
		mat = num[i];
		//continua a dividir um número até ser 0
		do{	
			if(mat % 2 === 1){
				numBinario[zer] = 1;	
			}
			else{
				numBinario[zer] = 0;
			}
			//divide o numero e o arredonda
			mat = Math.floor(mat / 2);
			
			zer++;
		}while(mat > 0);

		//coloca o numero da ordem certa
		var certoComprimento = numBinarioCerto.length;
		var contrario = numBinario.length-1;
		for(var x = 0; x < numBinario.length; x++){
			if(!isNaN(numBinario[contrario])){
			numBinarioCerto[certoComprimento] = numBinario[contrario];
			contrario--;
			certoComprimento++;
			}
		}
		//esvazia a array para o próxima numero
		i++
	}

	return numBinarioCerto;
}

</script>